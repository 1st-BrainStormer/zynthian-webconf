<div class="pull-right">
        <input id="check_advanced_view" type="checkbox" onChange="onchange_check_advanced_view()"/><span>Advanced view</span>
</div>

<h2>{{ escape(title) }}</h2>

<form id="ui-log-form" enctype="multipart/form-data" method="post">
	<button id="button-show-debug" type="button" value="SHOW_DEBUG" class="btn btn-lg btn-theme" onclick="show_debug_logging();">SHOW DEBUG LOGGING</button>
	<button id="button-hide-debug" type="button"  value="HIDE_DEBUG" class="btn btn-lg btn-theme" onclick="hide_debug_logging();">HIDE DEBUG LOGGING</button>

	<div id="ui-log" class="log-panel"></div>
</form>

<div id="loading-div-background">
  <div id="loading-div" class="ui-corner-all">
    PROCESSING. PLEASE WAIT...
  </div>
</div>

<script type="text/javascript">



function show_debug_logging() {
 	$('#button-show-debug').hide();
	var logDiv = $("#ui-log");

	logDiv.html('');
	var socketMessage = {"handler_name": "UiLogMessageHandler",
		"data": 'SHOW_DEBUG_LOGGING'};
	window.zynthianSocket.send(JSON.stringify(socketMessage));
	$('#button-hide-debug').show();

}

function hide_debug_logging() {
 	$('#button-hide-debug').hide();
 	var logDiv = $("#ui-log");

	logDiv.html('');

    var socketMessage = {"handler_name": "UiLogMessageHandler",
        "data": 'HIDE_DEBUG_LOGGING'};

    window.zynthianSocket.send(JSON.stringify(socketMessage));

    $('#button-show-debug').show();


}


function showProgressAnimation(){
    $("#loading-div-background").show();
}


function restore_advanced_view() {
        if (Cookies.get('advanced_view')) {
                $('input#check_advanced_view').prop("checked", true);
                $('.advanced-view').show();
        } else {
                $('input#check_advanced_view').prop("checked", false);
                $('.advanced-view').hide;
        }
}

function onchange_check_advanced_view() {
        if ($('input#check_advanced_view').prop("checked")==true) {
                Cookies.set('advanced_view','1')
                $('.advanced-view').slideDown(500);
        } else {
                Cookies.remove('advanced_view')
                $('.advanced-view').slideUp(500);
        }
}

$(document).ready(function() {
        restore_advanced_view();
        $('#button-show-debug').hide();
        $('#button-hide-debug').hide();


    	var deferred = $.Deferred();
		deferred.done(function(value) {
			$('#button-show-debug').show();
			window.zynthianSocket.registerHandler('UiLogMessageHandler', function(data) {
                if (data){
                    console.log("UiLogMessageHandler:onmessage:", data);
                    var logDiv = $("#ui-log");

                    logDiv.append(data + "<br />");
                    logDiv[0].scrollTop = logDiv[0].scrollHeight;

                }
	        });
	        var socketMessage = {"handler_name": "UiLogMessageHandler",
                 "data": 'SHOW_DEFAULT'};

            window.zynthianSocket.send(JSON.stringify(socketMessage));
		});
		connectZynthianWebSocket(deferred);

});


</script>
